<ion-header>
  <ion-toolbar color="primary">
    <ion-title>
      <span class="header-title-thin">momenTUM</span>
    </ion-title>
    <ion-buttons slot="secondary">
      <ion-button (click)="toggleTheme()">
        <ion-icon slot="icon-only" name="sunny"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="page-home ion-no-padding" scroll-y="false">
  <ion-refresher [hidden]="!hideEnrolOptions" slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content color="primary" pullingIcon="arrow-dropdown" refreshingSpinner="crescent">
    </ion-refresher-content>
  </ion-refresher>

  <!-- Displayed if user is not enrolled in a study -->
  <ion-img src="assets/imgs/tum-light.png" *ngIf="darkMode" [hidden]="hideEnrolOptions" class="enrolment-img-dark">
  </ion-img>
  <ion-img src="assets/imgs/tum-icon.png" *ngIf="!darkMode" [hidden]="hideEnrolOptions" class="enrolment-img-light">
  </ion-img>
  <div [hidden]="hideEnrolOptions" style="margin-top:5%">
    <h1 style="text-align:center;">Let's get started</h1>
    <p class="welcome-msg">
      Welcome to <span id="open-info" class="link">momenTUM</span> - a platform to participate in research surveys directly
      from your smartphone. Please read our <span id="open-privacy-policy" class="link">privacy policy</span> and confirm, before using the app.
    </p>
  </div>
  <!-- Displays if user is enrolled in a study -->
  <div [hidden]="!hideEnrolOptions" id="study-list">

    <ion-img *ngIf="study !== null" [hidden]="!hideEnrolOptions" [src]="study.properties.banner_url" class="banner-img"></ion-img>

    <div *ngFor="let task of task_list" [hidden]="!hideEnrolOptions">
      <ion-item *ngIf="task.type !== 'header'" detail lines="none">
        <ion-icon color="medium" name="{{task.type}}" slot="start"></ion-icon>
        <ion-label [routerLink]="task.type === 'alarm-outline' ? '/pvt/' + task.task_id : '/survey/' + task.task_id" routerDirection="forward" class="ion-text-wrap">
          <ion-text color="secondary"><span color="secondary" [innerHTML]="task.name"></span></ion-text>
          <br>
          <span *ngIf="!task.sticky" class="moment">{{task.moment}}</span>
        </ion-label>
      </ion-item>

      <ion-item *ngIf="task.type === 'header'"  lines="none">
        <ion-label stacked class="title-label">
          {{task.label}}
        </ion-label>
      </ion-item>
    </div>

    <ion-item lines="none" class="ion-text-center" [hidden]="task_list.length">
      <ion-label *ngIf="study !== null" class="ion-text-wrap">
        {{study.properties.empty_msg}}
        <br><br>
        <ion-icon style="font-size:3em;" color="secondary" name="partly-sunny"></ion-icon>
      </ion-label>
    </ion-item>

  </div>

  <!-- Privacy Policy -->
  <ion-modal trigger="open-privacy-policy">
    <ng-template>
      <ion-header>
        <ion-toolbar color="primary">
          <ion-buttons slot="start">
            <ion-button (click)="cancel('privacy policy')">Cancel</ion-button>
          </ion-buttons>
            <ion-title>
              <span class="header-title-thin">Privacy Policy</span>
            </ion-title>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <ion-textarea>
          this is a sample privacy policy text.
        </ion-textarea>
      </ion-content>
    </ng-template>
  </ion-modal>

  <!-- Info Page -->
  <ion-modal trigger="open-info">
    <ng-template>
      <ion-header>
        <ion-toolbar color="primary">
          <ion-buttons slot="start">
            <ion-button (click)="cancel('info')">Cancel</ion-button>
          </ion-buttons>
          <ion-title>
            <span class="header-title-thin">Info</span>
          </ion-title>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <ion-textarea>
          If you downloaded momenTUM, you either want to conduct a study,
          or you're someone, who was told to participate in a study.
          If you were told to participate in a study,
          momenTUM will be easy to use:
          Just enter the study link / QR Code / study ID that has been given to you, and click enter.
          If you want to create your own study, you have to do some preparation.
          You have to set up a server according to our API,
          then you will be ready to distribute your own study links.
          For more information check out our Github, or contact us.
          github repo:
        </ion-textarea>
      </ion-content>
    </ng-template>
  </ion-modal>


</ion-content>

<ion-footer [hidden]="hideEnrolOptions">

  <ion-item class="ion-text-center" (click)="scanBarcode()" lines="none">
    <ion-label>
      <ion-button expand="fill" size="medium" color="secondary">Scan QR Code</ion-button>
    </ion-label>
  </ion-item>
  <ion-item class="ion-text-center" (click)="enterURL()" lines="none">
    <ion-label>
      <ion-button expand="fill" size="medium" color="secondary">Enter URL</ion-button>
    </ion-label>
  </ion-item>
  <ion-item class="ion-text-center" (click)="enterStudyID()" lines="none">
    <ion-label>
      <ion-button expand="fill" size="medium" color="secondary">Study ID</ion-button>
    </ion-label>
  </ion-item>

</ion-footer>
